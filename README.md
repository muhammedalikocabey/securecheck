# SecureCheck

> **Modular Android Security Showcase** | MVVM + Clean Architecture + Dagger 2 + 25+ Production-grade security validation checks
> Implements real-world Android security strategies using structured architecture and modular design


SecureCheck is a modular, open-source Android application built to evaluate device and app integrity through over 25 runtime and system-level security checks, including Root, Debugger, Play Integrity, SafetyNet, SSL Pinning, and Frida/Xposed detection.

## Table of Contents

* [Features](#features)
* [Screenshots](#screenshots)
* [Setup & Run](#setup--run)
* [Architecture](#architecture)
* [Security Checks](#security-checks)
* [Testing & Debug](#testing--debug)
* [Project Structure](#project-structure)
* [Internationalization (i18n)](#internationalization-i18n)
* [Contribution](#contribution)
* [License](#license)
* [T√ºrk√ße A√ßƒ±klama](#t√ºrk√ße-a√ßƒ±klama)

---

## Features

| Check                    | Description                                                                              |
| ------------------------ | ---------------------------------------------------------------------------------------- |                              
| Root Detection           | Detect rooted devices                                                                    |
| Debugger Detection       | Checks debugger attachment                                                               |
| APK Signature            | Validates app signature via AES-encrypted hash comparison                                |
| Tamper Detection         | Detects APK repacking or build tampering                                                 |
| Obfuscation Check        | Ensures code is protected via ProGuard/R8                                                |
| Play Integrity API       | Uses official serverless API to verify genuine state                                     |
| SafetyNet Check          | Verifies CTS Profile & Basic Integrity                                                   |
| Exported Components      | Detects exported components in AndroidManifest                                           |
| PendingIntent Leak       | Detects unsafe FLAG\_MUTABLE usage                                                       |
| SSL Pinning              | Validates HTTPS via embedded certificate                                                 |
| Reflection Detection     | Analyzes reflection-prone class usage                                                    |
| Dex Loading              | Detects dynamically loaded `.dex` files at runtime                                       | 
| Frida/Xposed Detection   | Detects instrumentation frameworks                                                       |
| WebView Security         | Checks JS enable, file access, insecure JS interfaces                                    |
| Emulator/VPN/MockLoc     | Detects emulator, VPN usage, and mock location spoofing                                  |

All results are structured under a unified SecurityState model, which can be exported for audit or diagnostics.

---

<table>
  <tr>
    <th>MotionLayout Transition </th>
    <th>Security Summary</th>
  </tr>
  <tr>
    <td align="center">
      <img src="docs/images/motion.gif" alt="MotionLayout" width="320"/><br/>
      <sub><i>Shows animated transition using MotionLayout to visualize security results.</i></sub>
    </td>
    <td align="center">
      <img src="docs/images/security_report.png" alt="G√ºvenlik √∂zeti ekranƒ±" width="320"/><br/>
      <sub><i>Displays a full scan result rendered on the summary screen.</i></sub>
    </td>
  </tr>
</table>

---

## Setup & Run

```bash
git clone https://github.com/muhammedalikocabey/securecheck.git
cd securecheck
./gradlew clean assembleDebug
```

Security checks are triggered automatically at app launch via `MainActivity.kt

---

## Architecture

**Architecture Pattern:** MVVM + Clean Architecture + DI via Dagger 2
[UI] ‚Üí [ViewModel] ‚Üí [UseCase] ‚Üí [Detector/Checker] ‚Üí [Result]

```
app/
‚îú‚îÄ‚îÄ core/           # Low-level modules (Frida, Root, SSL)
‚îú‚îÄ‚îÄ data/           # Validators, log exporter, secure storage
‚îú‚îÄ‚îÄ domain/         # UseCases, Interfaces, Models
‚îú‚îÄ‚îÄ presentation/   # Compose UI, ViewModel, MotionLayout
‚îú‚îÄ‚îÄ di/             # AppComponent, Modules
```

### Key Design Principles:

* One-way data propagation from UI to domain logic ensures traceable state management
* Decoupled layers: UI ‚Üî Domain ‚Üî Data ‚Üî Core
* Dependency injection through Dagger 2 modules and qualifiers

---

## Security Checks

Security checks are centralized in `CompositeCheckSecurityUseCase`. Each module is responsible for a single aspect (e.g., root, debugger, VPN):

- [SafetyNet Attestation](https://developer.android.com/training/safetynet/attestation)
- [Play Integrity API](https://developer.android.com/google/play/integrity)

```kotlin
SecurityState(
  isRooted = false,
  isDebuggerAttached = false,
  isSignatureValid = true,
  ... // +20 more
)
```

* Passed ‚Äî Security check successful  
* Failed ‚Äî Potential risk detected  
* Info ‚Äî Suggestion provided in UI

Each check result is categorized as follows:

* Passed ‚Üí Green icon
* Failed ‚Üí Red warning + suggestion
* Suggestions from `strings.xml`

---

## Testing & Debug

* `FakeStateFactory`: preview safe/risky scenarios (debug builds only)
* `SecurityLogExporter`: JSON snapshot export of full SecurityState
* `SecureStorageManager`: tests EncryptedSharedPreferences + EncryptedFile
* Compose Previews available via `SecurityStatusScreenPreviewSafe()` in debug builds.

> Add `.crt` cert under `res/raw/securecheck_cert.crt` to test SSL pinning.

---

## Reporting

Each module produces a result that is consolidated into the SecurityState model, allowing the complete security status to be exported in structured JSON format.

The exported result format looks like this:
```json
{
  "isRooted": false,
  "isDebuggerAttached": false,
  "isFromPlayStore": true,
  "ctsProfileMatch": true,
  "basicIntegrity": true,
  "isGenuine": true,
  "riskLevel": "Safe",
  "overallSafe": true,
  "timestamp": 1715523375000
}
```

This enables sharing of scan results for compliance, audit, or bug analysis purposes.

A sample file is saved under:
```bash
/data/data/<your.package.name>/files/security_log.json
```
---

## Project Structure

```bash
core/
   ‚îú‚îÄ‚îÄ reverseanalysis/    # Frida, Xposed, Emulator
   ‚îú‚îÄ‚îÄ crypto/             # SecureCipher (AndroidKeyStore AES)
   ‚îú‚îÄ‚îÄ network/            # SSL Pinning, VPN detection
   ‚îú‚îÄ‚îÄ icc/                # Exported components, intent hijacking
   ‚îî‚îÄ‚îÄ webview/            # WebView security analyzer

data/
   ‚îú‚îÄ‚îÄ detector/           # Impl classes (signature, root, etc.)
   ‚îú‚îÄ‚îÄ local/secure/       # Secure storage helpers
   ‚îî‚îÄ‚îÄ log/                # Report exporter as JSON

domain/
   ‚îú‚îÄ‚îÄ usecase/            # All check use cases
   ‚îú‚îÄ‚îÄ model/              # SecurityState, WebViewSecurityResult
   ‚îî‚îÄ‚îÄ extension/          # riskLevel, passedCheckCount helpers

presentation/
   ‚îú‚îÄ‚îÄ screen/security/    # ViewModel + Compose screen
   ‚îú‚îÄ‚îÄ common/base/        # BaseViewModel
   ‚îú‚îÄ‚îÄ common/state/       # UiState sealed class
   ‚îî‚îÄ‚îÄ theme/              # Material3 + RiskColor provider
```

---

## Internationalization (i18n)

Multi-language support via:

* `values/strings.xml` (EN)
* `values-tr-rTR/strings.xml` (TR)

Example:

```xml
<string name="danger_frida">Frida instrumentation traces detected on the device.</string>
<string name="suggestion_frida">Frida may be active on device.</string>
```

---

## Contribution

Contributions are welcome via Pull Requests. Consider enhancing security modules, UI, or export features.

* New security modules (Magisk, dynamic analysis, SE-Linux)
* Snapshot encryption and remote sync (GitHub Actions, Firebase)
* UX optimization & performance enhancements
* UI test coverage for Compose screens

---

## Roadmap (V2 & Beyond)

> Target version: `v2.0.0` - Expected Q3 2025

Planned enhancements and extended detection modules for future releases:

### üîê Security Coverage Expansion
| Feature                                 | Description                                                                 |
|-----------------------------------------|-----------------------------------------------------------------------------|
| SELinux Enforcement Check             | Use `getenforce` command to verify SELinux mode (Enforcing / Permissive)   |
| Open Port Detection                   | Scan for unexpected open ports via `lsof` or `netstat`                      |
| App Sandbox Bypass Check              | Detect `run-as`, world-readable file leaks, or shared UID exploitation     |
| Native Layer Anti-Debugging          | Implement `ptrace`, `syscall`, and signal-based anti-debug detection       |
| Rootless / Magisk Bypass Detection    | Identify MagiskHide, Zygisk traces or root cloaking mechanisms             |
| BurpSuite / MITM Proxy Detection      | Check for custom CA injection, known proxy ports or Burp certificate       |

These features will be introduced under `core/advanced/` and integrated into `CompositeCheckSecurityUseCase` in version `v2.0.0`.

---

## License

```
MIT License

Copyright (c) 2025 Muhammed Ali Kocabey

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software...
```

---

**Maintainer:** [Muhammed Ali Kocabey](https://github.com/muhammedalikocabey)  
[muhammedalikocabey.com](https://muhammedalikocabey.com)  
[Shaping the Future of Android ‚Äì Spotify Podcast](https://open.spotify.com/show/7waAQAWmr2WIQNTlTJkkos)  
[Medium Articles](https://medium.com/@muhammedalikocabey)

---

## T√ºrk√ße A√ßƒ±klama

### SecureCheck Nedir?

SecureCheck, Android cihazlarda root eri≈üimi, debugger baƒülantƒ±sƒ±, sistem b√ºt√ºnl√ºƒü√º ihlalleri ve tersine m√ºhendislik giri≈üimleri gibi g√ºvenlik tehditlerini analiz etmek √ºzere tasarlanmƒ±≈ü, a√ßƒ±k kaynaklƒ± ve mod√ºler bir analiz uygulamasƒ±dƒ±r.

Kurumsal g√ºvenlik standartlarƒ±na uygun olarak tasarlanmƒ±≈ütƒ±r ve 25'ten fazla ger√ßek d√ºnya g√ºvenlik kontrol√ºn√º destekler.

### √ñne √áƒ±kan √ñzellikler

* Root, Debugger, Emulator, Frida, Xposed tespiti
* Play Integrity ve SafetyNet doƒürulamalarƒ±
* APK imzasƒ± ve obfuscation (ProGuard/R8) kontrolleri
* SSL Pinning (.crt ile doƒürulama)
* WebView JS g√ºvenliƒüi ve FLAG\_MUTABLE tespiti
* Compose + MotionLayout destekli modern UI
* Dagger 2 ile tam baƒüƒ±mlƒ±lƒ±k y√∂netimi
* MVVM + Clean Architecture yapƒ±sƒ±

<h3>Ekran G√∂r√ºnt√ºleri</h3>

<table>
  <tr>
    <th>MotionLayout Ge√ßi≈üi</th>
    <th>G√ºvenlik √ñzeti</th>
  </tr>
  <tr>
    <td align="center">
      <img src="docs/images/motion.gif" alt="MotionLayout ge√ßi≈ü animasyonu" width="320"/><br/>
      <sub><i>G√ºvenlik panelinin animasyonlu ge√ßi≈üi</i></sub>
    </td>
    <td align="center">
      <img src="docs/images/security_report.png" alt="G√ºvenlik √∂zeti ekranƒ±" width="320"/><br/>
      <sub><i>T√ºm kontrolleri g√∂steren statik ekran g√∂r√ºnt√ºs√º</i></sub>
    </td>
  </tr>
</table>

### Nasƒ±l √áalƒ±≈üƒ±r?

Uygulama a√ßƒ±ldƒ±ƒüƒ±nda `MainActivity.kt` i√ßinde `SecurityViewModel` tetiklenir. ViewModel, `CompositeCheckSecurityUseCase` √ºzerinden t√ºm g√ºvenlik kontrollerini sƒ±rayla y√ºr√ºt√ºr ve sonu√ßlarƒ± `SecurityState` modeline aktarƒ±r. UI katmanƒ±nda bu bilgiler g√∂rselle≈ütirilerek kullanƒ±cƒ±ya sunulur.

### Kurulum ve √áalƒ±≈ütƒ±rma

```bash
git clone https://github.com/muhammedalikocabey/securecheck.git
cd securecheck
./gradlew clean assembleDebug
```

### Kod Mimarisi

Proje katmanlarƒ±:

* `core/`: D√º≈ü√ºk seviyeli dedekt√∂rler (Frida, VPN, Dex vs.)
* `data/`: G√ºvenlik veri saƒülayƒ±cƒ±larƒ± ve log/export i≈ülemleri
* `domain/`: UseCase, modeller ve core interface'ler
* `presentation/`: Compose ekranlarƒ±, MotionLayout ve ViewModel
* `di/`: Dagger mod√ºl tanƒ±mlamalarƒ±

### Test ve Debug √ñzellikleri

* `FakeStateFactory`: G√ºvenli ve riskli √∂rnek senaryolarƒ± sim√ºle eder (sadece debug build)
* `SecurityLogExporter`: T√ºm g√ºvenlik durumu JSON formatƒ±nda dƒ±≈üa aktarƒ±lƒ±r
* `SecureStorageManager`: EncryptedFile ve EncryptedSharedPreferences test edilir
* `.crt` sertifikasƒ± ile SSL Pinning doƒürulamasƒ± yapƒ±labilir (`res/raw/securecheck_cert.crt`)

### Raporlama

* Her mod√ºl√ºn sonucu `SecurityState` yapƒ±sƒ±nda merkezi ≈üekilde toplanƒ±r ve JSON formatƒ±nda dƒ±≈üa aktarƒ±labilir.
* `AppIntegritySnapshot` ile JSON formatƒ±nda dƒ±≈üa aktarƒ±lƒ±r
* UI'da MotionLayout ge√ßi≈üiyle animasyonlu g√∂sterim saƒülanƒ±r


```json
{
  "isRooted": false,
  "isDebuggerAttached": false,
  "isFromPlayStore": true,
  "ctsProfileMatch": true,
  "basicIntegrity": true,
  "isGenuine": true,
  "riskLevel": "Safe",
  "overallSafe": true,
  "timestamp": 1715523375000
}
```

### Katkƒ± Sunmak

Projeye katkƒ±da bulunmak i√ßin forkladƒ±ktan sonra PR (pull request) a√ßabilirsiniz.

Memnuniyetle kar≈üƒ±lanan katkƒ±lar:

* Yeni g√ºvenlik kontrolleri (√∂r. Magisk, SELinux, dynamic analysis)
* MotionLayout veya UI iyile≈ütirmeleri
* JSON raporlamada yeni alanlar
* Test kapsamƒ± ve Compose UI testleri

### Yol Haritasƒ± (V2 & Sonrasƒ±)

Hedef S√ºr√ºm: v2.0.0 - Q3 2025

Gelecekteki versiyonlarda eklenmesi planlanan geli≈ümi≈ü g√ºvenlik kontrolleri:

| √ñzellik                                | A√ßƒ±klama                                                                 |
|----------------------------------------|--------------------------------------------------------------------------|
| SELinux Durumu Kontrol√º             | `getenforce` komutu ile Enforcing/Pemissive modu tespiti                 |
| A√ßƒ±k Port Tespiti                   | `lsof`, `netstat` gibi ara√ßlarla beklenmeyen a√ßƒ±k port analizi           |
| Sandbox Bypass Tespiti              | `run-as` komutu veya world-readable dosyalar ile izolasyon ihlali kontrol√º |
| Native Katman Anti-Debugging        | `ptrace`, `syscall` gibi native d√ºzeyde anti-debug teknikleri            |
| Magisk/Rootless Gizleme Tespiti     | MagiskHide, Zygisk gibi root gizleme mekanizmalarƒ±nƒ±n izlerini tespit     |
| BurpSuite/MITM Proxy Tespiti        | CA injeksiyonu, proxy portlarƒ± veya Burp sertifikasƒ± kontrol√º             |

Bu kontroller `core/advanced/` altƒ±nda tanƒ±mlanacak ve `CompositeCheckSecurityUseCase` i√ßerisine entegre edilecektir (v2.0.0 itibarƒ±yla).


### Lisans

MIT Lisansƒ± altƒ±nda a√ßƒ±k kaynaklƒ± olarak yayƒ±nlanmaktadƒ±r.

Geli≈ütirici: [Muhammed Ali Kocabey](https://github.com/muhammedalikocabey)  
[muhammedalikocabey.com](https://muhammedalikocabey.com)  
[Shaping the Future of Android ‚Äì Spotify Podcast](https://open.spotify.com/show/7waAQAWmr2WIQNTlTJkkos?si=7ee4f7c0487d40f0)
[Medium](https://medium.com/@muhammedalikocabey)
